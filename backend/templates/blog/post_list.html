{% extends "djangocms_stories/base.html" %}
{% load i18n l10n easy_thumbnails_tags cms_tags blog_tags djangocms_stories %}{% spaceless %}

{% block canonical_url %}<link rel="canonical" href="{{ view.get_view_url }}"/>{% endblock canonical_url %}

{% block content_blog %}
<section class="blog-list">
    {% block blog_title %}
    <header>
        <div class="bg-secondary background-grid">
            <div class="container py-6">
                {% if search_query %}
                    <h1 class="text-primary"><span class="h3 text-white">showing {{ postcontent_list|length }} results for</span> {{ search_query }}</h1>
                {% else %}
                    <h1 class="text-primary"><span class="h3 text-white">showing {{ postcontent_list|length }} of</span> {{ paginator.count }}</h1>
                {% endif %}
                <form method="get" action="{% namespace_url 'posts-latest' %}" class="d-flex flex-column flex-lg-row gap-2 mt-4 pt-2">
                    <input type="text" name="q" id="blogSearch" value="{{ search_query }}" placeholder="{% trans 'Search articles...' %}" class="form-control" />
                    <button type="submit" class="btn btn-primary py-3 px-4 h-100">
                        {% trans "search" %}
                    </button>
                </form>
            </div>
        </div>
    </header>
    {% endblock %}

    <div class="container">
        <div class="row pt-4 mt-2">
            <div class="col-12 col-lg-9 order-2 order-lg-1">
                {% for post_content in postcontent_list %}
                    {% include "blog/includes/post_item.html" with post_content=post_content image="true" TRUNCWORDS_COUNT=TRUNCWORDS_COUNT %}
                {% empty %}
                    <p class="blog-empty">{% trans "No article found." %}</p>
                {% endfor %}
            <div class="d-flex justify-content-center mt-4">
                {% if author or archive_date or tagged_entries %}
                    <p class="blog-back"><a href="{% namespace_url 'posts-latest' %}">{% trans "Back" %}</a></p>
                {% endif %}
                {% if is_paginated %}
                    {% pagination_range page_obj.number paginator.num_pages as page_range %}
                    <nav class="pagination-nav" aria-label="{% trans 'Pagination' %}">
                        <ul class="pagination">
                            <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
                                <a class="page-link fw-bold" {% if page_obj.has_previous %}href="{% page_url page_obj.previous_page_number %}"{% endif %} aria-label="{% trans 'Previous' %}">
                                    &lt;
                                </a>
                            </li>
                            {% for p in page_range %}
                                {% if p == "..." %}
                                    <li class="page-item">
                                        <span class="page-link fw-bold">&hellip;</span>
                                    </li>
                                {% elif p == page_obj.number %}
                                    <li class="page-item active" aria-current="page">
                                        <span class="page-link">{{ p }}</span>
                                    </li>
                                {% else %}
                                    <li class="page-item">
                                        <a class="page-link" href="{% page_url p %}">{{ p }}</a>
                                    </li>
                                {% endif %}
                            {% endfor %}
                            <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
                                <a class="page-link fw-bold" {% if page_obj.has_next %}href="{% page_url page_obj.next_page_number %}"{% endif %} aria-label="{% trans 'Next' %}">
                                    &gt;
                                </a>
                            </li>
                        </ul>
                    </nav>
                {% endif %}
            </div>
            </div>
            <div class="col-12 col-lg-3 order-1 order-lg-2">
                {% include "blog/includes/sidebar.html" %}
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% endspaceless %}